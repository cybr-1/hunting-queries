# Microsoft Sentinel / Defender KQL Hunting Queries

![.](https://i.pinimg.com/originals/da/0b/96/da0b965a91d6a9117ac47710a5e9341c.gif)

This repo will follow the MITRE ATT&CK structure, breaking down each category's main techniques and sub-techniques. There will also be some additional queries placed here that are always handy to have incase a quick search is neeeded.

Feel free to use what you think is useful or what you find as inspo.

Feedback is more than welcome.

---

# MITRE ATT&CK
> [!NOTE]
> Sub-techniques will be populated when queries are published on the repo

| Tactic | ID |
| :---------------- | :------: |
| Recon | [TA0043](https://attack.mitre.org/tactics/TA0043) |
| Resource Dev | [TA0042](https://attack.mitre.org/tactics/TA0042) |
| [Initial Access](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/003.%20Initial%20Access) | [TA0001](https://attack.mitre.org/tactics/TA0001) |
| Execution | [TA0002](https://attack.mitre.org/tactics/TA0002) |
| [Persistence](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/005.%20Persistence) | [TA0003](https://attack.mitre.org/tactics/TA0003) |
| [Priv Esc](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/006.%20Priv%20Esc) | [TA0004](https://attack.mitre.org/tactics/TA0004) |
| [Defence Evasion](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/007.%20Defence%20Evasion) | [TA0005](https://attack.mitre.org/tactics/TA0005) |
| [Cred Access](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/008.%20Credential%20Access) | [TA0006](https://attack.mitre.org/tactics/TA0006) |
| [Discovery](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/009.%20Discovery) | [TA0007](https://attack.mitre.org/tactics/TA0007) |
| [Lat Movement](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/010.%20Lateral%20Movement) | [TA0008](https://attack.mitre.org/tactics/TA0008) |
| Collection | [TA0009](https://attack.mitre.org/tactics/TA0009) |
| [C2](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/012.%20C2) | [TA0011](https://attack.mitre.org/tactics/TA0011) |
| [Exfil](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/013.%20Exfiltration) | [TA0010](https://attack.mitre.org/tactics/TA0010) |
| [Impact](https://github.com/cybr-1/hunting-queries/tree/main/ATT%26CK/014.%20Impact) | [TA0040](https://attack.mitre.org/tactics/TA0040) |

---

# Misc Queries

